digraph {
  rankdir=TD;

  node  [style="rounded,filled,bold", shape=box, fixedsize=true, width=1.3, fontname="Arial"];

  edge [weight = 100];
  "DEFINED" -> "SIGNAL" [label="signal_height"];
  "SIGNAL" -> "FAILED" [label="signal_period\nuasf disabled"];
  "LOCKED_IN" -> "ACTIVE" [label="1 period"];
  "QUIET" -> "UASF" [label="quiet_period"];
  "UASF" -> "LOCKED_IN" [label="uasf_period-1"];

  edge [weight = 1];
  "SIGNAL" -> "QUIET" [label="signal_period\nuasf enabled"];

  thresh [shape=point,width=0.01,height=0.01];
  "SIGNAL" -> thresh [dir=none, label="threshold passed"];
  "UASF" -> thresh [dir=none];
  "thresh" -> "LOCKED_IN";

  "SIGNAL" [fillcolor="#a0a0ff"];
  "QUIET" [fillcolor="#a0a0ff"];
  "UASF" [fillcolor="#a0a0ff"];

  "LOCKED_IN" [fillcolor="#ffffa0"];
  "ACTIVE" [fillcolor="#a0ffa0", shape=box];

  "FAILED" [fillcolor="#ffa0a0", shape=box];

  { rank=same; "SIGNAL" "QUIET" }
  { rank=sink; "FAILED" "ACTIVE"; }
}


